$(".dt").mask("00/0000"),$(".div_dates").hide(),$(".dt").datepicker({format:"mm/yyyy",autoclose:"true",language:"pt-BR",startView:"months",minViewMode:"months",startDate:new Date((new Date).setDate((new Date).getDate()-365)),endDate:new Date((new Date).setDate((new Date).getDate()+60))}),$("#type").on("change",(function(){"CORRENTE"==$(this).val()?($(".div_dates").hide(),$(".dt").val("")):$(".div_dates").show()}));var table=$("#list").DataTable({dom:"Bfrtip",buttons:[{extend:"csv",text:"Exportar tabela",filename:"base_investidores",fieldSeparator:";",fieldBoundary:"",charset:"UTF-8",bom:!0}],responsive:!0,pageLength:100,autoWidth:!0,language:{url:"/assets/plugins/datatables/pt_br.json",select:{rows:{_:"VocÃª selecionou %d linhas",0:"Clique na linha para selecionar",1:"Apenas 1 linha foi selecionada"}},buttons:{copyTitle:"Tabela copiada",copySuccess:{_:"%d linhas copiadas",1:"1 linha copiada"}}},processing:!0,searching:!0,ajax:{url:$("#route_list").val(),type:"GET",data:function(e){e.type=$("#type").val(),e.start_date=$("#start_date").val().split("/").reverse().join("-")+"-01",e.end_date=$("#end_date").val().split("/").reverse().join("-")+"-01"},error:function(e,t,a){$("#bt").prop("disabled",!1).html("Listar"),$("#bt-export").prop("disabled",!1),$("#list_processing").hide(),$("#list > tbody").html('<tr class="odd"><td valign="top" colspan="6" class="dataTables_empty">Erro ao carregar, pesquise novamente!</td></tr>')}},initComplete:function(e,t){$("#bt").prop("disabled",!1).html("Listar"),$("#bt-export").prop("disabled",!1)},order:[[1,"asc"]],columns:[{data:"cpf"},{data:"nome"},{data:"cargo_parentesco"},{data:"dependente"},{data:"cpf_responsavel"}]});frmValidate("#frm",{start_date:{required:{depends:function(e){var t=!1;if("CORRENTE"!=$("#type").val())t=!0;return t}}},end_date:{required:{depends:function(e){var t=!1;if("CORRENTE"!=$("#type").val())t=!0;return t}}}},{start_date:{required:"Informe, por favor!"},end_date:{required:"Informe, por favor!"}}),$("#bt").prop("disabled",!0).html("Aguarde..."),$("#bt-export").prop("disabled",!0),$("#bt").on("click",(function(){$("#frm").valid()&&($("#bt").prop("disabled",!0).html("Aguarde..."),$("#bt-export").prop("disabled",!0),table.clear().draw(),table.ajax.reload((function(e){$("#bt").prop("disabled",!1).html("Listar"),$("#bt-export").prop("disabled",!1)})))})),$("#bt-export").on("click",(function(){let e=`${$("#route_export").val()}?type=${$("#type").val()}&start_date=${$("#start_date").val().split("/").reverse().join("-")+"-01"}&end_date=${$("#end_date").val().split("/").reverse().join("-")+"-01"}`,t=document.createElement("a");t.href=e,t.click(),t.remove()}));
