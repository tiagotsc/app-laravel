var table=$("#list").DataTable({pageLength:50,responsive:!0,autoWidth:!1,language:{url:"/assets/plugins/datatables/pt_br.json",select:{rows:{_:"Você selecionou %d linhas",0:"Clique na linha para selecionar",1:"Apenas 1 linha foi selecionada"}},buttons:{copyTitle:"Tabela copiada",copySuccess:{_:"%d linhas copiadas",1:"1 linha copiada"}}},order:[[1,"desc"]],searching:!0,ajax:$("#route_list").val(),initComplete:function(t,a){$((function(){$('[data-toggle="tooltip"]').tooltip()}))},columns:[{class:"details-control",orderable:!1,data:null,defaultContent:"",width:"2%"},{data:"id",width:"4%"},{data:"name",width:"10%",orderable:!1,render:function(t,a,e){let o="Sem referência";return null!=e.original_name&&(o=`Referente ao lote ${e.original_name.substr(15,2)}/${e.original_name.substr(17,2)}/${e.original_name.substr(19,4)}`),`<spa data-toggle="tooltip" data-placement="top" title="${o}">${e.name.substr(19)}</span>`}},{data:"count_total",width:"6%"},{data:"value_total",width:"12%",orderable:!0,render:function(t,a,e){return parseFloat(e.value_total).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}},{data:"downloaded",className:"text-center",width:"3%",render:function(t,a,e){let o="";return o="yes"==e.downloaded?`<b class="text-info" data-toggle="tooltip" data-placement="top" title="Última baixa realizada em ${e.updated_at}">Sim</b>`:'<b class="text-danger">Não</b>',o}},{data:"count_undefined",width:"3%",orderable:!0,render:function(t,a,e){return null==e.count_undefined?"":e.count_undefined}},{data:"created_at",width:"9%"},{data:"id",className:"text-center",orderable:!1,width:"2%",render:function(t,a,e){let o="";return o+=`<a href="#" data-bs-toggle="modal" data-bs-target="#modal-confirm" data_url="${$("#route_export").val().replace("*",e.id)}" class="get_lote ms-2" data_name="${e.name}" data-toggle="tooltip" data-placement="top" title="Obter lote">\n                                    <i class="bi bi-file-earmark-text-fill fs-5"></i>\n                                </a>`,o}}]}),detailRows=[];$("#list tbody").on("click","tr td.details-control",(function(){var t=$(this).closest("tr"),a=table.row(t),e=$.inArray(t.attr("id"),detailRows);if(a.child.isShown())t.removeClass("details"),a.child.hide(),detailRows.splice(e,1);else{t.addClass("details");let o=null!=a.data().count_total_unknown?a.data().count_total_unknown:0,n=null!=a.data().value_total_unknown?a.data().value_total_unknown:0;n=parseFloat(n).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let l=null!=a.data().count_proceeds?a.data().count_proceeds:0,r=null!=a.data().value_proceeds?a.data().value_proceeds:0;r=parseFloat(r).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let d=null!=a.data().count_not_proceeds?a.data().count_not_proceeds:0,i=null!=a.data().value_not_proceeds?a.data().value_not_proceeds:0;i=parseFloat(i).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let c=null!=a.data().count_correction?a.data().count_correction:0,s=null!=a.data().value_correction?a.data().value_correction:0;s=parseFloat(s).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let u=null!=a.data().count_not_correction?a.data().count_not_correction:0,p=null!=a.data().value_not_correction?a.data().value_not_correction:0;p=parseFloat(p).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let b=`<table class="table table-bordered">\n                        <thead class="table-dark">\n                            <tr>\n                                <th data-toggle="tooltip" data-placement="top" title="Qtd. de registros ainda não baixados, incluindo trilhões">Sem retorno <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                                <th colspan="2">Desconhecido (Trilhões)</th>\n                            </tr>\n                        </thead>\n                        <tr>\n                            <td><b>Qtd:</b> ${null!=a.data().count_undefined?a.data().count_undefined:0}</td>\n                            <td><b>Qtd.:</b> ${o}</td>\n                            <td><b>Valor:</b> ${n}</td>\n                        </tr>\n                    </table>`,_=`<table class="table table-bordered">\n                        <thead class="table-dark">\n                            <tr>\n                                <th colspan="2">Procede</th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos">Não procede <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos + corrigidos">Corrigido <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos + não corrigidos">Não corrigido <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                            </tr>\n                        </thead>\n                        <tr>\n                            <td><b>Qtd.:</b><br>${l}</td>\n                            <td><b>Valor:</b><br>${r}</td>\n                            <td><b>Qtd.:</b><br>${d}</td>\n                            <td><b>Valor:</b><br>${i}</td>\n                            <td><b>Qtd.:</b><br>${c}</td>\n                            <td><b>Valor:</b><br>${s}</td>\n                            <td><b>Qtd.:</b><br>${u}</td>\n                            <td><b>Valor:</b><br>${p}</td>\n                        </tr>\n                    </table>`;a.child(b+_).show(),-1===e&&detailRows.push(t.attr("id"))}$((function(){$('[data-toggle="tooltip"]').tooltip()}))})),table.on("draw",(function(){$.each(detailRows,(function(t,a){$("#"+a+" td.details-control").trigger("click")}))})),$("#list tbody").on("click",".get_lote",(function(t){t.preventDefault();let a=$(this).attr("data_url"),e=$(this).attr("data_name");$(this);feedsModalConfirm("O lote será enviado para seu email, tudo bem?",e,a),$("#bt-modal-confirm").off("click"),$("#bt-modal-confirm").on("click",(async function(t){await modalConfirmExecute("Aguarde, enviando lote para seu email...","Poof! Em instante chegará na sua caixa de entrada.")}))}));
