let permissionDestroy=$("#allow_del_batch").val();var table=$("#list").DataTable({pageLength:50,responsive:!0,autoWidth:!1,language:{url:"/assets/plugins/datatables/pt_br.json",select:{rows:{_:"Você selecionou %d linhas",0:"Clique na linha para selecionar",1:"Apenas 1 linha foi selecionada"}},buttons:{copyTitle:"Tabela copiada",copySuccess:{_:"%d linhas copiadas",1:"1 linha copiada"}}},order:[[1,"desc"]],searching:!0,ajax:$("#route_list").val(),initComplete:function(t,a){$((function(){$('[data-toggle="tooltip"]').tooltip()}))},columns:[{class:"details-control",orderable:!1,data:null,defaultContent:"",width:"2%"},{data:"id",width:"4%"},{data:"batch_date",width:"8%",orderable:!1},{data:"count_total",width:"6%",render:function(t,a,e){return e.count_total+""}},{data:"value_total",width:"10%",orderable:!0,render:function(t,a,e){return parseFloat(e.value_total).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}},{data:"downloaded",className:"text-center",width:"3%",render:function(t,a,e){let o="";return o="yes"==e.downloaded?`<b class="text-info" data-toggle="tooltip" data-placement="top" title="Última baixa realizada em ${e.updated_at}">Sim</b>`:'<b class="text-danger">Não</b>',o}},{data:"count_undefined",width:"3%",orderable:!0,render:function(t,a,e){return null==e.count_undefined?"":e.count_undefined}},{data:"created_at",width:"9%"},{data:"id",className:"text-center",orderable:!1,width:"2%",render:function(t,a,e){let o="";return o+=`<a href="#" data-bs-toggle="modal" data-bs-target="#modal-confirm" data_url="${$("#route_export").val().replace("*",e.id)}" class="get_lote ms-2" data_name="${e.batch_date}" data-toggle="tooltip" data-placement="top" title="Obter lote">\n                            <i class="bi bi-file-earmark-text-fill fs-5"></i>\n                        </a>`,o}}]}),detailRows=[];$("#list tbody").on("click","tr td.details-control",(function(){var t=$(this).closest("tr"),a=table.row(t),e=$.inArray(t.attr("id"),detailRows);if(a.child.isShown())t.removeClass("details"),a.child.hide(),detailRows.splice(e,1);else{t.addClass("details");let o=a.data().count_detail_total,l=null!=a.data().count_proceeds?a.data().count_proceeds:0,n=null!=a.data().value_proceeds?a.data().value_proceeds:0;n=parseFloat(n).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let d=null!=a.data().count_not_proceeds?a.data().count_not_proceeds:0,r=null!=a.data().value_not_proceeds?a.data().value_not_proceeds:0;r=parseFloat(r).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let i=null!=a.data().count_correction?a.data().count_correction:0,c=null!=a.data().value_correction?a.data().value_correction:0;c=parseFloat(c).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});let s=null!=a.data().count_not_correction?a.data().count_not_correction:0,u=null!=a.data().value_not_correction?a.data().value_not_correction:0;u=parseFloat(u).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});null!=a.data().count_undefined&&a.data().count_undefined;let p=`<table class="table table-bordered">\n                        <thead class="table-dark">\n                            <tr>\n                                \x3c!--<th>Registros</th>--\x3e\n                                <th colspan="2">Procede</th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos">Não procede <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos + corrigidos">Corrigido <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                                <th colspan="2" data-toggle="tooltip" data-placement="top" title="Qtd. de não procede + incorretos + não corrigidos">Não corrigido <i class="fa fa-info-circle text-info" aria-hidden="true"></i></th>\n                            </tr>\n                        </thead>\n                        <tr>\n                            \x3c!--<td><b>Qtd.:</b><br>${o}</td>--\x3e\n                            <td><b>Qtd.:</b><br>${l}</td>\n                            <td><b>Valor:</b><br>${n}</td>\n                            <td><b>Qtd.:</b><br>${d}</td>\n                            <td><b>Valor:</b><br>${r}</td>\n                            <td><b>Qtd.:</b><br>${i}</td>\n                            <td><b>Valor:</b><br>${c}</td>\n                            <td><b>Qtd.:</b><br>${s}</td>\n                            <td><b>Valor:</b><br>${u}</td>\n                        </tr>\n                    </table>`;a.child(p).show(),-1===e&&detailRows.push(t.attr("id"))}$((function(){$('[data-toggle="tooltip"]').tooltip()}))})),table.on("draw",(function(){$.each(detailRows,(function(t,a){$("#"+a+" td.details-control").trigger("click")}))})),$("#list tbody").on("click",".get_lote",(function(t){t.preventDefault();let a=$(this).attr("data_url"),e=$(this).attr("data_name");$(this);feedsModalConfirm("O lote será enviado para seu email, tudo bem?",e,a),$("#bt-modal-confirm").off("click"),$("#bt-modal-confirm").on("click",(async function(t){await modalConfirmExecute("Aguarde, enviando lote para seu email...","Poof! Em instante chegará na sua caixa de entrada.")}))}));
