document.addEventListener("alpine:init",(()=>{Alpine.data("managerFrm",(()=>({modalStatus:new bootstrap.Modal(document.getElementById("modal-status")),data:{_token:document.head.querySelector("meta[name=csrf-token]").content,_method:null!==document.querySelector('input[name="_method"]')?document.querySelector('input[name="_method"]').value:""},scenarios:["BENEFICIO_PROPRIO","BENEFICIO_PARENTE","BENEFICIO_COLABORADOR","DUPLICIDADE","RECORRENCIA","QTD_PARCELAS","VALOR_ALTO"],services:["ICREDIV","CREDIVC"],prefixes:["ATACADO","CORPORATIVO"],loading:!1,buttonLabel:"Gravar",cleanFields(){this.data.day_delete_old_raw_files="",this.data.year_delete_old_zipped_files="",this.data.minimum_value="",this.data.scenarios_without_value="",this.data.only_services="",this.data.month_recurrence="",this.data.upper_portion="",this.data.higher_value="",this.data.prefix_outside="",this.data.year_maintain_batches="",document.getElementById("day_delete_old_raw_files").value="",document.getElementById("year_delete_old_zipped_files").value="",document.getElementById("minimum_value").value="",document.getElementById("scenarios_without_value").value="",document.getElementById("only_services").value="",document.getElementById("month_recurrence").value="",document.getElementById("upper_portion").value="",document.getElementById("higher_value").value="",document.getElementById("prefix_outside").value="",document.getElementById("year_maintain_batches").value=""},setModalStatus(e,t){document.getElementById("title-modal-status").innerText=e,document.getElementById("desc-status-modal").innerText=t},submitData(){$("#frm").valid()&&(this.data.day_delete_old_raw_files=document.getElementById("day_delete_old_raw_files").value,this.data.year_delete_old_zipped_files=document.getElementById("year_delete_old_zipped_files").value,this.data.minimum_value=document.getElementById("minimum_value").value,this.data.scenarios_without_value=$("#scenarios_without_value").val().join(","),this.data.only_services=$("#only_services").val().join(","),this.data.month_recurrence=document.getElementById("month_recurrence").value,this.data.upper_portion=document.getElementById("upper_portion").value,this.data.higher_value=document.getElementById("higher_value").value,this.data.prefix_outside=$("#prefix_outside").val().join(","),this.data.year_maintain_batches=document.getElementById("year_maintain_batches").value,this.buttonLabel="Aguarde...",this.loading=!0,fetch(document.getElementById("frm").action,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.data)}).then((e=>{1!=e.ok&&this.setModalStatus("Algo errado!","Se persistir, fale com o administrador!"),e.json().then((e=>{e.status?this.setModalStatus("Muito bom!","Configuração aplicada com sucesso!"):this.setModalStatus("Error no processamento!","Se persistir, fale com o administrador!")}))})).catch((()=>{this.setModalStatus("Error grave!","Se persistir, fale com o administrador!")})).finally((()=>{this.loading=!1,this.buttonLabel="Gravar",this.data={},$("#scenarios_without_value,#only_services,#prefix_outside").val(null).trigger("change"),$("p.error").hide(),table.clear().draw(),table.ajax.reload(),this.cleanFields(),this.modalStatus.show()})))}})))}));
