document.addEventListener("alpine:init",(()=>{Alpine.data("managerFrm",(()=>({data:{_token:document.head.querySelector("meta[name=csrf-token]").content,_method:null!==document.querySelector('input[name="_method"]')?document.querySelector('input[name="_method"]').value:""},loading:!1,buttonLabel:"Alterar credencial",modalConfirm:new bootstrap.Modal(document.getElementById("confirmCredencial")),loadData(){document.querySelector("#identification").addEventListener("change",(e=>{this.getCredencial()}))},getCredencial(){let e=document.getElementById("identification").value,t=document.getElementById("username").value,a=document.getElementById("password").value;if(""==e)return t="",void(a="");this.loading=!0,this.buttonLabel="Carregando credencial...",fetch($("#route_get").val().replace("_",e),{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{1!=e.ok&&swal("Algo errado ao carregar dados!","Se persistir, fale com o administrador!","error"),e.json().then((e=>{document.getElementById("username").value=e.username,document.getElementById("password").value=e.password}))})).catch((()=>{swal("Error ao carregar dados!","Se persistir, fale com o administrador!","error")})).finally((()=>{this.loading=!1,this.buttonLabel="Alterar credencial",$(".error").hide()}))},confirmApply(){if($("#frm").valid()){let e=document.getElementById("identification").value;document.getElementById("credencial-name").innerText=e,this.modalConfirm.show()}},setModalStatus(e,t){document.getElementById("title-modal-status").innerText=e,document.getElementById("desc-status-modal").innerText=t},submitData(){if($("#frm").valid()){this.buttonLabel="Aguarde...",this.loading=!0;let e=document.getElementById("identification").value,t=document.getElementById("username").value,a=document.getElementById("password").value;this.data.username=t,this.data.password=a,this.modalConfirm.hide(),fetch(document.getElementById("frm").action.replace("_",e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.data)}).then((e=>{1!=e.ok&&this.setModalStatus("Algo errado!","Se persistir, fale com o administrador!"),e.json().then((e=>{this.setModalStatus("Muito bom!","Alterado com sucesso!")}))})).catch((()=>{this.setModalStatus("Error grave!","Se persistir, fale com o administrador!")})).finally((()=>{function e(){$((function(){$('[data-toggle="tooltip"]').tooltip()}))}this.loading=!1,this.buttonLabel="Alterar credencial",table.clear().draw(),table.ajax.reload(e),document.getElementById("identification").value="",document.getElementById("username").value="",document.getElementById("password").value="",new bootstrap.Modal(document.getElementById("modal-status")).show()}))}}})))}));
