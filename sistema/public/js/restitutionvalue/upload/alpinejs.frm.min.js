document.addEventListener("alpine:init",(()=>{Alpine.data("managerFrm",(()=>({modalStatus:new bootstrap.Modal(document.getElementById("modal-status")),data:{_token:document.head.querySelector("meta[name=csrf-token]").content,_method:"post"},loading:!1,buttonLabel:"Enviar",setModalStatus(e,t){document.getElementById("title-modal-status").innerText=e,document.getElementById("desc-status-modal").innerText=t},loadData(){document.querySelector("#file").addEventListener("change",(e=>{$("#frm").valid()}))},submitData(){if($("#frm").valid()){let e=this,t=new FormData,n=$("#file")[0].files;t.append("file",n[0]),t.append("_token",document.head.querySelector("meta[name=csrf-token]").content),this.buttonLabel="Aguarde, enviando arquivo...",this.loading=!0;let o=new XMLHttpRequest;o.responseType="json",o.onload=function(){200===o.status?e.setModalStatus("Muito bom!","Em breve você receberá o lote por email!"):e.setModalStatus("Algo errado!","Se persistir, fale com o administrador!"),e.modalStatus.show(),document.getElementById("progress-bar").style.width="0%",document.getElementById("progress-bar").innerHTML="0%",e.loading=!1,e.buttonLabel="Enviar",document.getElementById("file").value=""},o.upload.onprogress=function(e){let t=Math.round(e.loaded/e.total*100);document.getElementById("progress-bar").style.width=t+"%",document.getElementById("progress-bar").innerHTML=t+"%"},o.open("POST",document.getElementById("frm").action),o.send(t)}}})))}));
